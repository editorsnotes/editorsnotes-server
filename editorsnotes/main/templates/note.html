{% extends "base.html" %}
{% load typogrify display note_sections staticfiles %}

{% block title %}: {{ note.title }}{% endblock %}

{% block js %}

  {% if can_edit %}
  <script type="text/javascript" src="{% static "function/wysihtml5/wysihtml5-0.3.0.js" %}"></script>
  <script type="text/javascript" src="{% static "function/wysihtml5/parser_rules.js" %}"></script>
  <script type="text/javascript" src="{% static "function/zotero-jquery/zotero-functions.js" %}"></script>

  <script type="text/javascript" src="{% static "function/backbone/app.js" %}"></script>
  <script type="text/javascript" src="{% static "function/backbone/models.js" %}"></script>
  <script type="text/javascript" src="{% static "function/backbone/templates.js" %}"></script>
  <script type="text/javascript" src="{% static "function/backbone/views.js" %}"></script>
  <script type="text/javascript" src="{% static "function/note.js" %}"></script>
  {% endif %}

{% endblock %}

{% block content %}
    <header><h2>{{ note.title|typogrify }}</h2></header>

    <section id="note-details">

      <div id="note-about">

        <div>
          <strong>This note is </strong>
          {% if note.status == '0' %}<span class="note-status-closed">closed</span>
          {% elif note.status == '1' %}<span class="note-status-open">open</span>
          {% else %}<span class="note-status-hibernating">hibernating</span>{% endif %}
        </div>

        <div id="note-related-topics">
          <span>Related topics</span>
          <ul class="unstyled">
            {% for topic in topics %}
            <li>{{ topic|as_link }}</li>
            {% empty %}
            <span class="quiet">none</span>
            {% endfor %}
          </ul>
        </div>

      </div>

      <dl id="note-authorship" class="dl-horizontal">
        <dt>Project</dt>
        <dd>{{ note.project|as_link }}</dd>

        {% with authors=note.get_all_updaters %}
        <dt>Author{% if authors|length > 1 %}s{% endif %}</dt>
        <dd>
          <ul class="unstyled">
          {% for author in authors %}<li>{{ author|as_link }}</li>{% endfor %}
          </ul>
        </dd>
        {% endwith %}

        <dt>License</dt>
        <dd>
        <a class="license-link" href="{{ license.url }}" title="{{ license }}">
          {% for symbol in license.symbols %}<i class="license-symbol">{{ symbol }}</i>{% endfor %}
        </a>
        </dd>

        <dt>Last updated</dt>
        <dd>{{ note.last_updated }} (<a href="#">view history</a>)</dd>
      </dl>
    </section>

    <section id="note-description">
      {{ note.content|as_html }}
    </section>

    <section id="note-sections">
      {% for section in sections %}{% include section|ns_template_name %}{% endfor %}
    </section>

    {% if can_edit %}
    <div style="display: none;">
      {% csrf_token %}
      {% include "includes/wysihtml5_full_toolbar.html" with toolbar_id="note-section-toolbar"%}
    </div>
    {% endif %}

    </div>

{% endblock %}
